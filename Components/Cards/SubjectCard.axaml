<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:u="https://irihi.tech/ursa"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="SubjectHelper.Components.Cards.SubjectCard"
             x:Name="Root">
    
    <UserControl.Resources>
        <SolidColorBrush x:Key="CardBackground" Color="#212121"/>
        <SolidColorBrush x:Key="CardBottomBackground" Color="#303030"/>
    </UserControl.Resources>

    <Border 
        Background="{StaticResource CardBackground}" 
        Width="384" 
        Height="148" 
        BorderThickness="2.5 0 0 2.5"
        BorderBrush="{Binding BorderColor, ElementName=Root}" 
        CornerRadius="16">

        <Grid 
            RowDefinitions="70*, 30*">
            <StackPanel 
                Grid.Row="0"
                HorizontalAlignment="Left" Spacing="5"
                Margin="10 10">
                <TextBlock
                    Text="{Binding Title, ElementName=Root}"
                    FontSize="20"
                    FontWeight="Medium"
                    TextWrapping="Wrap"
                    Width="300" />

                <TextBlock
                    Text="{Binding Code, ElementName=Root}"
                    FontSize="14"
                    FontWeight="Light" />
            </StackPanel>

            <Border
                Grid.Row="1"
                Background="{StaticResource CardBottomBackground}"
                CornerRadius="0 0 16 16">

                <StackPanel
                    Orientation="Horizontal"
                    Spacing="10"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Margin="0 0 15 0">

                    <Button
                        Classes="Icon"
                        VerticalAlignment="Center"
                        Theme="{DynamicResource BorderlessButton}"
                        Command="{Binding ViewCommand, ElementName=Root}"
                        CommandParameter="{Binding ViewParameter, ElementName=Root}"
                        Padding="0"
                        Width="24">
                        <Label FontFamily="{StaticResource FaRegular}"
                               Content="&#xf06e;"
                               Padding="0"
                               FontSize="18"
                               Foreground="{StaticResource ViewIconColor}" />
                    </Button>

                    <Button
                        Classes="Icon"
                        VerticalAlignment="Center"
                        Theme="{DynamicResource BorderlessButton}"
                        Command="{Binding EditCommand, ElementName=Root}"
                        CommandParameter="{Binding EditParameter, ElementName=Root}"
                        Padding="0"
                        Width="24">
                        <Label FontFamily="{StaticResource FaRegular}"
                               Content="&#xf044;"
                               Padding="0"
                               FontSize="18"
                               Foreground="{StaticResource EditIconColor}" />
                    </Button>

                    <u:PopConfirm
                        x:Name="PopConfirm"
                        PopupHeader="Delete Subject?"
                        Placement="TopEdgeAlignedRight"
                        ConfirmCommand="{Binding DeleteCommand, ElementName=Root}"
                        ConfirmCommandParameter="{Binding DeleteParameter, ElementName=Root}">
                        <u:PopConfirm.PopupContent>
                            <MultiBinding
                                StringFormat="This will permanently delete the subject '{0}' and all of its data. This action cannot be undone">
                                <Binding Path="Title" ElementName="Root"/>
                            </MultiBinding>
                        </u:PopConfirm.PopupContent>

                        <u:PopConfirm.KeyBindings>
                            <KeyBinding Gesture="Enter"
                                        Command="{Binding ConfirmCommand, ElementName=PopConfirm}"
                                        CommandParameter="{Binding ConfirmCommandParameter, ElementName=PopConfirm}" />
                        </u:PopConfirm.KeyBindings>

                        <Button
                            Classes="Icon"
                            VerticalAlignment="Center"
                            Theme="{DynamicResource BorderlessButton}"
                            Padding="0"
                            Width="24">
                            <Label FontFamily="{StaticResource FaRegular}"
                                   Content="&#xf2ed;"
                                   Padding="0"
                                   FontSize="18"
                                   Foreground="{StaticResource DeleteIconColor}" />
                        </Button>
                    </u:PopConfirm>

                </StackPanel>

            </Border>

        </Grid>
    </Border>

</UserControl>